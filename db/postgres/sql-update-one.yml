version: 3
short: "updates a single row in a postgres table"
language: sql
type: file
features: 
  - go-hex-feature
  - go-hex-update
 

key: feature-sql
fileName: "update_{{ .Name | snake | singular }}.sql"

model: entity
body: |
  update {{ .Schema}}.{{ .Name}} set
    {{ range $index, $col := .NonPrimaryColumns }}
  {{- if $index }},{{end}} {{ $col.Name }} = ${{ increment $index }}
  {{ end }}
  where 
    {{ range $index, $col := .PrimaryKeys }}
  {{- if $index }}AND {{end}} {{ $col.Name }} = ${{ increment $index }}
  {{ end }}
  
  returning id;